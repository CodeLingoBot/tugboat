!!!
%html
  %head
    %script{ src: '//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js' }
    %script{ src: 'https://d3dy5gmtp8yhk7.cloudfront.net/2.0/pusher.min.js' }
    %script{ src: '//ajax.googleapis.com/ajax/libs/angularjs/1.2.12/angular.js' }
    %script{ src: '//ajax.googleapis.com/ajax/libs/angularjs/1.2.12/angular-resource.js' }
    %script{ src: '//cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.0/angular-ui-router.min.js' }
    %script{ src: '//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.5.2/underscore-min.js' }
    %script{ src: '//cdnjs.cloudflare.com/ajax/libs/jq-console/2.7.7/jqconsole.min.js' }

    %meta{ charset: 'utf-8' }
    %title Shipr
    %meta{ name: 'viewport', content: 'width=device-width, initial-scale=1.0' }
    %meta{ name: 'pusher.key', content: Shipr.pusher.key }

    %link{ href: 'http://bootswatch.com/flatly/bootstrap.min.css', rel: 'stylesheet' }

    %link{ href: asset_path('app.css'), rel: 'stylesheet' }
    %script{ src: asset_path('app.js') }

  %body(id="app" ng-app="app" ng-init="user = #{@user.to_json}")
    %div(ui-view="header")
    %div(ui-view="content")

    %script(type="text/ng-template" id="header.html")
      .navbar.navbar-default.navbar-static-top
        .container
          .navbar-header
            %a.navbar-brand(href="" ui-sref="app.jobs.list") Shipr
          .navbar-collapse.collapse
            %ul.nav.navbar-nav.navbar-right
              %img.gravatar(ng-src="{{user.gravatar}}")

    %script(type="text/ng-template" id="content.html")
      .container(ui-view)

    %script(type="text/ng-template" id="jobs.html")
      %div(ui-view)
    
    %script(type="text/ng-template" id="jobs/list.html")
      %h2.page-header Deploys
      %table.table.table-striped
        %thead
          %tr
            %th #
            %th Repo
            %th Branch
        %tbody
          %tr(ng-repeat="job in jobs | orderBy:'id':true")
            %td(ng-bind="job.id")
            %td
              %a(href="" ui-sref="app.jobs.detail({ jobId: job.id })" ng-bind="job.repo")
            %td(ng-bind="job.branch")

    %script(type="text/ng-template" id="jobs/detail.html")
      %ul.breadcrumb
        %li
          %a(href="" ui-sref="app.jobs.list") Deploys
        %li.active
          %strong(ng-bind="job.repo")
      %h1.status
        %span.text-info(ng-if="!job.done") Deploying
        %span.text-success(ng-if="job.done && job.success") Deployed
        %span.text-danger(ng-if="job.done && !job.success") Failed
      .panel.panel-primary
        .panel-heading Environment Variables
        .panel-body
          {{ job.config }}
      #log(ng-bind="job.output")
